
function get_hostname {
	env | grep SSH_CLIENT > /dev/null 2>&1
	if  [ $? -eq 0 ]; then echo "[${CYAN}${HOSTNAME}${C_RESET}]"
	else
		 if [[ ${UID} == 0 ]]; then
		    echo "[${RED}${HOSTNAME}${C_RESET}]"
		 fi
	fi
}

function git_prompt {
    if ! git rev-parse --git-dir > /dev/null 2>&1; then
        return 0
    fi
    echo ":$(git branch 2>/dev/null| sed -n '/^\*/s/^\* //p')"
}

function git_prompt_color {
    if ! git rev-parse --git-dir > /dev/null 2>&1; then
        return 0
    fi
    local git_branch=$(git branch 2>/dev/null| sed -n '/^\*/s/^\* //p')
    if git diff --quiet 2>/dev/null >&2; then
        echo "[$git_branch ${GREEN}✓${C_RESET}]"
    else
        echo "[$git_branch ${RED}✗${C_RESET}]"
    fi
}

function precmd {
    local target="[${CYAN}${PWD/#$HOME/\~}${C_RESET}]"
    local prefix="${TITLEBAR}┌─$(get_hostname)$(git_prompt_color)${target}"
    if [[ ${USER} == "root" ]]; then
        export PS1="${prefix}\n└─${RED}▪ ${C_RESET}"
    else
        export PS1="${prefix}\n└─${CYAN}▪ ${C_RESET}"
    fi
    export PS2="└─▪ "
    export PS3=">>> "
}

export PROMPT_COMMAND=precmd

